diff -Npru stock-services/smali/com/android/server/am/BroadcastQueue.smali ext-services/smali/com/android/server/am/BroadcastQueue.smali
--- stock-services/smali/com/android/server/am/BroadcastQueue.smali	2012-11-06 15:04:29.098613155 -0600
+++ ext-services/smali/com/android/server/am/BroadcastQueue.smali	2012-11-06 15:04:20.054568304 -0600
@@ -559,6 +559,118 @@
     goto :goto_153
 .end method
 
+.method private enforcePrivacyPermission(Ljava/lang/Object;Lcom/android/server/am/BroadcastRecord;)V
+    .registers 10
+
+    if-eqz p2, :cond_3b
+
+    iget-object v4, p2, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    if-eqz v4, :cond_3b
+
+    iget-object v4, p2, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    invoke-virtual {v4}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v4
+
+    if-eqz v4, :cond_3b
+
+    const/4 v2, 0x0
+
+    const/4 v3, -0x1
+
+    :try_start_10
+    instance-of v4, p1, Lcom/android/server/am/BroadcastFilter;
+
+    if-eqz v4, :cond_3c
+
+    move-object v0, p1
+
+    check-cast v0, Lcom/android/server/am/BroadcastFilter;
+
+    move-object v4, v0
+
+    iget-object v4, v4, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;
+
+    iget-object v4, v4, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;
+
+    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+
+    iget-object v2, v4, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
+
+    check-cast p1, Lcom/android/server/am/BroadcastFilter;
+
+    iget-object v4, p1, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;
+
+    iget-object v4, v4, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;
+
+    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+
+    iget v3, v4, Landroid/content/pm/ApplicationInfo;->uid:I
+    :try_end_2a
+    .catch Ljava/lang/Exception; {:try_start_10 .. :try_end_2a} :catch_53
+
+    :cond_2a
+    :goto_2a
+    if-eqz v2, :cond_3b
+
+    const/4 v4, -0x1
+
+    if-eq v3, v4, :cond_3b
+
+    iget-object v4, p2, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    const/4 v5, 0x0
+
+    iget-object v6, p2, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
+
+    invoke-interface {v6}, Ljava/util/List;->size()I
+
+    move-result v6
+
+    invoke-static {v2, v3, v4, v5, v6}, Landroid/privacy/surrogate/PrivacyActivityManagerService;->enforcePrivacyPermission(Ljava/lang/String;ILandroid/content/Intent;Landroid/content/Context;I)V
+
+    :cond_3b
+    :goto_3b
+    return-void
+
+    :cond_3c
+    :try_start_3c
+    instance-of v4, p1, Landroid/content/pm/ResolveInfo;
+
+    if-eqz v4, :cond_2a
+
+    move-object v0, p1
+
+    check-cast v0, Landroid/content/pm/ResolveInfo;
+
+    move-object v4, v0
+
+    iget-object v4, v4, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
+
+    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;
+
+    iget-object v2, v4, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
+
+    check-cast p1, Landroid/content/pm/ResolveInfo;
+
+    iget-object v4, p1, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
+
+    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;
+
+    iget v3, v4, Landroid/content/pm/ApplicationInfo;->uid:I
+    :try_end_52
+    .catch Ljava/lang/Exception; {:try_start_3c .. :try_end_52} :catch_53
+
+    goto :goto_2a
+
+    :catch_53
+    move-exception v1
+
+    goto :goto_3b
+.end method
+
 .method private static performReceiveLocked(Lcom/android/server/am/ProcessRecord;Landroid/content/IIntentReceiver;Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;ZZ)V
     .registers 16
     .annotation system Ldalvik/annotation/Throws;
@@ -1931,15 +2043,15 @@
 .end method
 
 .method final processNextBroadcast(Z)V
-    .registers 37
+    .registers 38
 
     move-object/from16 v0, p0
 
     iget-object v0, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v34, v0
+    move-object/from16 v35, v0
 
-    monitor-enter v34
+    monitor-enter v35
 
     :try_start_7
     move-object/from16 v0, p0
@@ -1976,15 +2088,15 @@
 
     invoke-virtual {v3, v5}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;
 
-    move-result-object v27
+    move-result-object v28
 
-    check-cast v27, Lcom/android/server/am/BroadcastRecord;
+    check-cast v28, Lcom/android/server/am/BroadcastRecord;
 
     invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J
 
     move-result-wide v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J
 
@@ -1992,11 +2104,11 @@
 
     move-result-wide v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchClockTime:J
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
@@ -2004,43 +2116,43 @@
 
     move-result v12
 
-    const/16 v17, 0x0
+    const/16 v18, 0x0
 
     :goto_44
-    move/from16 v0, v17
+    move/from16 v0, v18
 
     if-ge v0, v12, :cond_61
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
-    move/from16 v0, v17
+    move/from16 v0, v18
 
     invoke-interface {v3, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
-    move-result-object v30
+    move-result-object v31
 
-    check-cast v30, Lcom/android/server/am/BroadcastFilter;
+    check-cast v31, Lcom/android/server/am/BroadcastFilter;
 
     const/4 v3, 0x0
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v27
+    move-object/from16 v1, v28
 
-    move-object/from16 v2, v30
+    move-object/from16 v2, v31
 
     invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/BroadcastQueue;->deliverToRegisteredReceiverLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/BroadcastFilter;Z)V
 
-    add-int/lit8 v17, v17, 0x1
+    add-int/lit8 v18, v18, 0x1
 
     goto :goto_44
 
     :cond_61
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v27
+    move-object/from16 v1, v28
 
     invoke-direct {v0, v1}, Lcom/android/server/am/BroadcastQueue;->addBroadcastToHistoryLocked(Lcom/android/server/am/BroadcastRecord;)V
 
@@ -2049,7 +2161,7 @@
     :catchall_69
     move-exception v3
 
-    monitor-exit v34
+    monitor-exit v35
     :try_end_6b
     .catchall {:try_start_7 .. :try_end_6b} :catchall_69
 
@@ -2094,17 +2206,17 @@
 
     if-nez v3, :cond_94
 
-    const/16 v19, 0x1
+    const/16 v20, 0x1
 
     :goto_8f
     monitor-exit v5
     :try_end_90
     .catchall {:try_start_79 .. :try_end_90} :catchall_97
 
-    if-nez v19, :cond_9a
+    if-nez v20, :cond_9a
 
     :try_start_92
-    monitor-exit v34
+    monitor-exit v35
     :try_end_93
     .catchall {:try_start_92 .. :try_end_93} :catchall_69
 
@@ -2112,7 +2224,7 @@
     return-void
 
     :cond_94
-    const/16 v19, 0x0
+    const/16 v20, 0x0
 
     goto :goto_8f
 
@@ -2201,7 +2313,7 @@
     iput-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;
 
     :cond_e2
-    const/16 v21, 0x0
+    const/16 v22, 0x0
 
     :cond_e4
     move-object/from16 v0, p0
@@ -2220,7 +2332,7 @@
 
     invoke-virtual {v3}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V
 
-    if-eqz v21, :cond_fe
+    if-eqz v22, :cond_fe
 
     move-object/from16 v0, p0
 
@@ -2229,7 +2341,7 @@
     invoke-virtual {v3}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()V
 
     :cond_fe
-    monitor-exit v34
+    monitor-exit v35
 
     goto :goto_93
 
@@ -2242,25 +2354,25 @@
 
     invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
-    move-result-object v27
+    move-result-object v28
 
-    check-cast v27, Lcom/android/server/am/BroadcastRecord;
+    check-cast v28, Lcom/android/server/am/BroadcastRecord;
 
-    const/16 v16, 0x0
+    const/16 v17, 0x0
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
     if-eqz v3, :cond_1dd
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
     invoke-interface {v3}, Ljava/util/List;->size()I
 
-    move-result v25
+    move-result v26
 
     :goto_11b
     move-object/from16 v0, p0
@@ -2271,7 +2383,7 @@
 
     if-eqz v3, :cond_1d4
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J
 
@@ -2283,11 +2395,11 @@
 
     invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J
 
-    move-result-wide v23
+    move-result-wide v24
 
-    if-lez v25, :cond_1d4
+    if-lez v26, :cond_1d4
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J
 
@@ -2299,7 +2411,7 @@
 
     mul-long/2addr v7, v9
 
-    move/from16 v0, v25
+    move/from16 v0, v26
 
     int-to-long v9, v0
 
@@ -2307,7 +2419,7 @@
 
     add-long/2addr v5, v7
 
-    cmp-long v3, v23, v5
+    cmp-long v3, v24, v5
 
     if-lez v3, :cond_1d4
 
@@ -2343,7 +2455,7 @@
 
     move-result-object v5
 
-    move-wide/from16 v0, v23
+    move-wide/from16 v0, v24
 
     invoke-virtual {v5, v0, v1}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
 
@@ -2355,7 +2467,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-wide v6, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J
 
@@ -2369,7 +2481,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-wide v6, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J
 
@@ -2383,7 +2495,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -2397,7 +2509,7 @@
 
     move-result-object v5
 
-    move/from16 v0, v25
+    move/from16 v0, v26
 
     invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
@@ -2409,7 +2521,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I
 
@@ -2423,7 +2535,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
@@ -2443,55 +2555,55 @@
 
     invoke-virtual {v0, v3}, Lcom/android/server/am/BroadcastQueue;->broadcastTimeoutLocked(Z)V
 
-    const/16 v16, 0x1
+    const/16 v17, 0x1
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
     :cond_1d4
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
     if-eqz v3, :cond_1e1
 
-    monitor-exit v34
+    monitor-exit v35
 
     goto/16 :goto_93
 
     :cond_1dd
-    const/16 v25, 0x0
+    const/16 v26, 0x0
 
     goto/16 :goto_11b
 
     :cond_1e1
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
     if-eqz v3, :cond_1f7
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget v3, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I
 
-    move/from16 v0, v25
+    move/from16 v0, v26
 
     if-ge v3, v0, :cond_1f7
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-boolean v3, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z
 
     if-nez v3, :cond_1f7
 
-    if-eqz v16, :cond_23a
+    if-eqz v17, :cond_23a
 
     :cond_1f7
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->resultTo:Landroid/content/IIntentReceiver;
     :try_end_1fb
@@ -2500,31 +2612,31 @@
     if-eqz v3, :cond_224
 
     :try_start_1fd
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->callerApp:Lcom/android/server/am/ProcessRecord;
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v4, v0, Lcom/android/server/am/BroadcastRecord;->resultTo:Landroid/content/IIntentReceiver;
 
     new-instance v5, Landroid/content/Intent;
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
     invoke-direct {v5, v6}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v7, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v8, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;
 
@@ -2536,12 +2648,12 @@
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->resultTo:Landroid/content/IIntentReceiver;
     :try_end_224
     .catchall {:try_start_1fd .. :try_end_224} :catchall_69
-    .catch Landroid/os/RemoteException; {:try_start_1fd .. :try_end_224} :catch_2b0
+    .catch Landroid/os/RemoteException; {:try_start_1fd .. :try_end_224} :catch_2e2
 
     :cond_224
     :goto_224
@@ -2550,7 +2662,7 @@
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v27
+    move-object/from16 v1, v28
 
     invoke-direct {v0, v1}, Lcom/android/server/am/BroadcastQueue;->addBroadcastToHistoryLocked(Lcom/android/server/am/BroadcastRecord;)V
 
@@ -2562,22 +2674,22 @@
 
     invoke-virtual {v3, v5}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;
 
-    const/16 v27, 0x0
+    const/16 v28, 0x0
 
-    const/16 v21, 0x1
+    const/16 v22, 0x1
 
     :cond_23a
-    if-eqz v27, :cond_e4
+    if-eqz v28, :cond_e4
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I
 
-    move/from16 v28, v0
+    move/from16 v29, v0
 
-    add-int/lit8 v3, v28, 0x1
+    add-int/lit8 v3, v29, 0x1
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I
 
@@ -2585,17 +2697,17 @@
 
     move-result-wide v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J
 
-    if-nez v28, :cond_262
+    if-nez v29, :cond_262
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J
 
@@ -2603,7 +2715,7 @@
 
     move-result-wide v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchClockTime:J
 
@@ -2614,7 +2726,7 @@
 
     if-nez v3, :cond_279
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J
 
@@ -2622,74 +2734,126 @@
 
     iget-wide v7, v0, Lcom/android/server/am/BroadcastQueue;->mTimeoutPeriod:J
 
-    add-long v32, v5, v7
+    add-long v33, v5, v7
 
     move-object/from16 v0, p0
 
-    move-wide/from16 v1, v32
+    move-wide/from16 v1, v33
 
     invoke-virtual {v0, v1, v2}, Lcom/android/server/am/BroadcastQueue;->setBroadcastTimeoutLocked(J)V
 
     :cond_279
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
-    move/from16 v0, v28
+    move/from16 v0, v29
 
     invoke-interface {v3, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
-    move-result-object v22
+    move-result-object v23
+
+    move-object/from16 v0, p0
+
+    move-object/from16 v1, v23
+
+    move-object/from16 v2, v28
+
+    invoke-direct {v0, v1, v2}, Lcom/android/server/am/BroadcastQueue;->enforcePrivacyPermission(Ljava/lang/Object;Lcom/android/server/am/BroadcastRecord;)V
+
+    const/4 v15, 0x0
+
+    if-eqz v28, :cond_2b0
+
+    move-object/from16 v0, v28
+
+    iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    if-eqz v3, :cond_2b0
+
+    move-object/from16 v0, v28
+
+    iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    invoke-virtual {v3}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v3
+
+    if-eqz v3, :cond_2b0
+
+    move-object/from16 v0, v28
+
+    iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    invoke-virtual {v3}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v3
+
+    const-string v5, "catchBootComplete"
+
+    invoke-virtual {v3, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v3
+
+    if-eqz v3, :cond_2b0
 
-    move-object/from16 v0, v22
+    const/4 v15, 0x1
+
+    :cond_2b0
+    move-object/from16 v0, v23
 
     instance-of v3, v0, Lcom/android/server/am/BroadcastFilter;
 
-    if-eqz v3, :cond_2dd
+    if-eqz v3, :cond_323
 
-    move-object/from16 v0, v22
+    move-object/from16 v0, v23
 
     check-cast v0, Lcom/android/server/am/BroadcastFilter;
 
-    move-object v15, v0
+    move-object/from16 v16, v0
+
+    if-nez v15, :cond_30f
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-boolean v3, v0, Lcom/android/server/am/BroadcastRecord;->ordered:Z
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v27
+    move-object/from16 v1, v28
 
-    invoke-direct {v0, v1, v15, v3}, Lcom/android/server/am/BroadcastQueue;->deliverToRegisteredReceiverLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/BroadcastFilter;Z)V
+    move-object/from16 v2, v16
 
-    move-object/from16 v0, v27
+    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/BroadcastQueue;->deliverToRegisteredReceiverLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/BroadcastFilter;Z)V
+
+    :goto_2cb
+    move-object/from16 v0, v28
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;
 
-    if-eqz v3, :cond_2a5
+    if-eqz v3, :cond_2d7
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-boolean v3, v0, Lcom/android/server/am/BroadcastRecord;->ordered:Z
 
-    if-nez v3, :cond_2ad
+    if-nez v3, :cond_2df
 
-    :cond_2a5
+    :cond_2d7
     const/4 v3, 0x0
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/BroadcastQueue;->scheduleBroadcastsLocked()V
 
-    :cond_2ad
-    monitor-exit v34
+    :cond_2df
+    monitor-exit v35
 
     goto/16 :goto_93
 
-    :catch_2b0
+    :catch_2e2
     move-exception v14
 
     const-string v3, "BroadcastQueue"
@@ -2718,7 +2882,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -2734,34 +2898,57 @@
 
     goto/16 :goto_224
 
-    :cond_2dd
-    move-object/from16 v0, v22
+    :cond_30f
+    const/4 v3, 0x0
+
+    move-object/from16 v0, v28
+
+    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;
+
+    const/4 v3, 0x0
+
+    move-object/from16 v0, v28
+
+    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;
+
+    move-object/from16 v0, v28
+
+    iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    const-string v5, "android.intent.action.BOOT_COMPLETED"
+
+    invoke-virtual {v3, v5}, Landroid/content/Intent;->setAction(Ljava/lang/String;)Landroid/content/Intent;
+
+    goto :goto_2cb
+
+    :cond_323
+    move-object/from16 v0, v23
 
     check-cast v0, Landroid/content/pm/ResolveInfo;
 
-    move-object/from16 v18, v0
+    move-object/from16 v19, v0
 
-    const/16 v29, 0x0
+    const/16 v30, 0x0
 
     move-object/from16 v0, p0
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-object v4, v5, Landroid/content/pm/ActivityInfo;->permission:Ljava/lang/String;
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget v5, v0, Lcom/android/server/am/BroadcastRecord;->callingPid:I
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v7, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -2769,7 +2956,7 @@
 
     iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v8, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -2777,17 +2964,17 @@
 
     invoke-virtual/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;IIIZ)I
 
-    move-result v26
+    move-result v27
 
-    if-eqz v26, :cond_397
+    if-eqz v27, :cond_3dd
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-boolean v3, v3, Landroid/content/pm/ActivityInfo;->exported:Z
 
-    if-nez v3, :cond_446
+    if-nez v3, :cond_499
 
     const-string v3, "BroadcastQueue"
 
@@ -2801,7 +2988,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -2819,7 +3006,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;
 
@@ -2833,7 +3020,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingPid:I
 
@@ -2847,7 +3034,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
@@ -2867,7 +3054,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -2885,7 +3072,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -2901,7 +3088,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -2917,11 +3104,11 @@
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    :goto_395
-    const/16 v29, 0x1
+    :goto_3db
+    const/16 v30, 0x1
 
-    :cond_397
-    move-object/from16 v0, v18
+    :cond_3dd
+    move-object/from16 v0, v19
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -2931,26 +3118,26 @@
 
     const/16 v5, 0x3e8
 
-    if-eq v3, v5, :cond_41f
+    if-eq v3, v5, :cond_465
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;
-    :try_end_3a7
-    .catchall {:try_start_224 .. :try_end_3a7} :catchall_69
+    :try_end_3ed
+    .catchall {:try_start_224 .. :try_end_3ed} :catchall_69
 
-    if-eqz v3, :cond_41f
+    if-eqz v3, :cond_465
 
-    :try_start_3a9
+    :try_start_3ef
     invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
 
     move-result-object v3
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v5, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -2959,16 +3146,16 @@
     iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
     invoke-interface {v3, v5, v6}, Landroid/content/pm/IPackageManager;->checkPermission(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_3bc
-    .catchall {:try_start_3a9 .. :try_end_3bc} :catchall_69
-    .catch Landroid/os/RemoteException; {:try_start_3a9 .. :try_end_3bc} :catch_4c8
+    :try_end_402
+    .catchall {:try_start_3ef .. :try_end_402} :catchall_69
+    .catch Landroid/os/RemoteException; {:try_start_3ef .. :try_end_402} :catch_51b
 
-    move-result v26
+    move-result v27
 
-    :goto_3bd
-    if-eqz v26, :cond_41f
+    :goto_403
+    if-eqz v27, :cond_465
 
-    :try_start_3bf
+    :try_start_405
     const-string v3, "BroadcastQueue"
 
     new-instance v5, Ljava/lang/StringBuilder;
@@ -2981,7 +3168,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -2995,7 +3182,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3013,7 +3200,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;
 
@@ -3027,7 +3214,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;
 
@@ -3041,7 +3228,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
@@ -3061,53 +3248,66 @@
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    const/16 v29, 0x1
+    const/16 v30, 0x1
 
-    :cond_41f
-    move-object/from16 v0, v27
+    :cond_465
+    move-object/from16 v0, v28
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;
 
-    if-eqz v3, :cond_42f
+    if-eqz v3, :cond_475
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;
 
     iget-boolean v3, v3, Lcom/android/server/am/ProcessRecord;->crashing:Z
 
-    if-eqz v3, :cond_42f
+    if-eqz v3, :cond_475
+
+    const/16 v30, 0x1
+
+    :cond_475
+    if-eqz v15, :cond_482
+
+    const/16 v30, 0x1
+
+    move-object/from16 v0, v28
+
+    iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    const-string v5, "android.intent.action.BOOT_COMPLETED"
 
-    const/16 v29, 0x1
+    invoke-virtual {v3, v5}, Landroid/content/Intent;->setAction(Ljava/lang/String;)Landroid/content/Intent;
 
-    :cond_42f
-    if-eqz v29, :cond_4cd
+    :cond_482
+    if-eqz v30, :cond_520
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/BroadcastQueue;->scheduleBroadcastsLocked()V
 
-    monitor-exit v34
+    monitor-exit v35
 
     goto/16 :goto_93
 
-    :cond_446
+    :cond_499
     const-string v3, "BroadcastQueue"
 
     new-instance v5, Ljava/lang/StringBuilder;
@@ -3120,7 +3320,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -3138,7 +3338,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;
 
@@ -3152,7 +3352,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingPid:I
 
@@ -3166,7 +3366,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
@@ -3186,7 +3386,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3202,7 +3402,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3218,7 +3418,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3234,23 +3434,23 @@
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto/16 :goto_395
+    goto/16 :goto_3db
 
-    :catch_4c8
+    :catch_51b
     move-exception v14
 
-    const/16 v26, -0x1
+    const/16 v27, -0x1
 
-    goto/16 :goto_3bd
+    goto/16 :goto_403
 
-    :cond_4cd
+    :cond_520
     const/4 v3, 0x1
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3258,7 +3458,7 @@
 
     new-instance v3, Landroid/content/ComponentName;
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3266,7 +3466,7 @@
 
     iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3274,29 +3474,29 @@
 
     invoke-direct {v3, v5, v6}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget v3, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
     const/16 v5, 0x3e8
 
-    if-eq v3, v5, :cond_521
+    if-eq v3, v5, :cond_574
 
     move-object/from16 v0, p0
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-object v5, v5, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3304,48 +3504,48 @@
 
     invoke-virtual {v3, v5, v6}, Lcom/android/server/am/ActivityManagerService;->isSingleton(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;)Z
 
-    move-result v20
+    move-result v21
 
-    if-eqz v20, :cond_56a
+    if-eqz v21, :cond_5bd
 
-    const/16 v31, 0x0
+    const/16 v32, 0x0
 
-    :goto_50f
+    :goto_562
     move-object/from16 v0, p0
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
-    move/from16 v0, v31
+    move/from16 v0, v32
 
     invoke-virtual {v3, v5, v0}, Lcom/android/server/am/ActivityManagerService;->getActivityInfoForUser(Landroid/content/pm/ActivityInfo;I)Landroid/content/pm/ActivityInfo;
 
     move-result-object v3
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iput-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
-    :cond_521
-    move-object/from16 v0, v18
+    :cond_574
+    move-object/from16 v0, v19
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curReceiver:Landroid/content/pm/ActivityInfo;
-    :try_end_529
-    .catchall {:try_start_3bf .. :try_end_529} :catchall_69
+    :try_end_57c
+    .catchall {:try_start_405 .. :try_end_57c} :catchall_69
 
-    :try_start_529
+    :try_start_57c
     invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
 
     move-result-object v3
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v5, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
@@ -3355,7 +3555,7 @@
 
     const/4 v6, 0x0
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget v7, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
@@ -3364,18 +3564,18 @@
     move-result v7
 
     invoke-interface {v3, v5, v6, v7}, Landroid/content/pm/IPackageManager;->setPackageStoppedState(Ljava/lang/String;ZI)V
-    :try_end_541
-    .catchall {:try_start_529 .. :try_end_541} :catchall_69
-    .catch Landroid/os/RemoteException; {:try_start_529 .. :try_end_541} :catch_671
-    .catch Ljava/lang/IllegalArgumentException; {:try_start_529 .. :try_end_541} :catch_573
+    :try_end_594
+    .catchall {:try_start_57c .. :try_end_594} :catchall_69
+    .catch Landroid/os/RemoteException; {:try_start_57c .. :try_end_594} :catch_6c4
+    .catch Ljava/lang/IllegalArgumentException; {:try_start_57c .. :try_end_594} :catch_5c6
 
-    :goto_541
-    :try_start_541
+    :goto_594
+    :try_start_594
     move-object/from16 v0, p0
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3387,16 +3587,16 @@
 
     move-result-object v13
 
-    if-eqz v13, :cond_5bc
+    if-eqz v13, :cond_60f
 
     iget-object v3, v13, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;
-    :try_end_555
-    .catchall {:try_start_541 .. :try_end_555} :catchall_69
+    :try_end_5a8
+    .catchall {:try_start_594 .. :try_end_5a8} :catchall_69
 
-    if-eqz v3, :cond_5bc
+    if-eqz v3, :cond_60f
 
-    :try_start_557
-    move-object/from16 v0, v18
+    :try_start_5aa
+    move-object/from16 v0, v19
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3406,30 +3606,30 @@
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v27
+    move-object/from16 v1, v28
 
     invoke-direct {v0, v1, v13}, Lcom/android/server/am/BroadcastQueue;->processCurBroadcastLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/ProcessRecord;)V
-    :try_end_567
-    .catchall {:try_start_557 .. :try_end_567} :catchall_69
-    .catch Landroid/os/RemoteException; {:try_start_557 .. :try_end_567} :catch_59f
+    :try_end_5ba
+    .catchall {:try_start_5aa .. :try_end_5ba} :catchall_69
+    .catch Landroid/os/RemoteException; {:try_start_5aa .. :try_end_5ba} :catch_5f2
 
-    :try_start_567
-    monitor-exit v34
+    :try_start_5ba
+    monitor-exit v35
 
     goto/16 :goto_93
 
-    :cond_56a
-    move-object/from16 v0, v27
+    :cond_5bd
+    move-object/from16 v0, v28
 
     iget v3, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
     invoke-static {v3}, Landroid/os/UserId;->getUserId(I)I
 
-    move-result v31
+    move-result v32
 
-    goto :goto_50f
+    goto :goto_562
 
-    :catch_573
+    :catch_5c6
     move-exception v14
 
     const-string v3, "BroadcastQueue"
@@ -3444,7 +3644,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
@@ -3472,9 +3672,9 @@
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto :goto_541
+    goto :goto_594
 
-    :catch_59f
+    :catch_5f2
     move-exception v14
 
     const-string v3, "BroadcastQueue"
@@ -3489,7 +3689,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
@@ -3503,12 +3703,12 @@
 
     invoke-static {v3, v5, v14}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    :cond_5bc
+    :cond_60f
     move-object/from16 v0, p0
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3516,7 +3716,7 @@
 
     const/4 v6, 0x1
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v7, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -3528,11 +3728,11 @@
 
     const-string v8, "broadcast"
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v9, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v10, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -3544,22 +3744,22 @@
 
     and-int/2addr v10, v11
 
-    if-eqz v10, :cond_660
+    if-eqz v10, :cond_6b3
 
     const/4 v10, 0x1
 
-    :goto_5e5
+    :goto_638
     const/4 v11, 0x0
 
     invoke-virtual/range {v3 .. v11}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;ZZ)Lcom/android/server/am/ProcessRecord;
 
     move-result-object v3
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;
 
-    if-nez v3, :cond_662
+    if-nez v3, :cond_6b5
 
     const-string v3, "BroadcastQueue"
 
@@ -3573,7 +3773,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3591,7 +3791,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v18
+    move-object/from16 v0, v19
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3609,7 +3809,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -3631,23 +3831,23 @@
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v27
+    move-object/from16 v1, v28
 
     invoke-virtual {v0, v1}, Lcom/android/server/am/BroadcastQueue;->logBroadcastReceiverDiscardLocked(Lcom/android/server/am/BroadcastRecord;)V
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget v7, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v8, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-object v9, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iget-boolean v10, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z
 
@@ -3655,7 +3855,7 @@
 
     move-object/from16 v5, p0
 
-    move-object/from16 v6, v27
+    move-object/from16 v6, v28
 
     invoke-virtual/range {v5 .. v11}, Lcom/android/server/am/BroadcastQueue;->finishReceiverLocked(Lcom/android/server/am/BroadcastRecord;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z
 
@@ -3663,42 +3863,42 @@
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v27
+    move-object/from16 v0, v28
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
-    monitor-exit v34
+    monitor-exit v35
 
     goto/16 :goto_93
 
-    :cond_660
+    :cond_6b3
     const/4 v10, 0x0
 
-    goto :goto_5e5
+    goto :goto_638
 
-    :cond_662
-    move-object/from16 v0, v27
+    :cond_6b5
+    move-object/from16 v0, v28
 
     move-object/from16 v1, p0
 
     iput-object v0, v1, Lcom/android/server/am/BroadcastQueue;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;
 
-    move/from16 v0, v28
+    move/from16 v0, v29
 
     move-object/from16 v1, p0
 
     iput v0, v1, Lcom/android/server/am/BroadcastQueue;->mPendingBroadcastRecvIndex:I
 
-    monitor-exit v34
-    :try_end_66f
-    .catchall {:try_start_567 .. :try_end_66f} :catchall_69
+    monitor-exit v35
+    :try_end_6c2
+    .catchall {:try_start_5ba .. :try_end_6c2} :catchall_69
 
     goto/16 :goto_93
 
-    :catch_671
+    :catch_6c4
     move-exception v3
 
-    goto/16 :goto_541
+    goto/16 :goto_594
 .end method
 
 .method public final replaceOrderedBroadcastLocked(Lcom/android/server/am/BroadcastRecord;)Z
