diff -Npruw stock-services/smali/com/android/server/am/BroadcastQueue.smali pdroid-services/smali/com/android/server/am/BroadcastQueue.smali
--- stock-services/smali/com/android/server/am/BroadcastQueue.smali	2013-11-13 08:42:32.309457489 -0600
+++ pdroid-services/smali/com/android/server/am/BroadcastQueue.smali	2013-11-13 08:42:47.417457926 -0600
@@ -655,6 +655,118 @@
     goto :goto_188
 .end method
 
+.method private enforcePrivacyPermission(Ljava/lang/Object;Lcom/android/server/am/BroadcastRecord;)V
+    .registers 10
+
+    if-eqz p2, :cond_3b
+
+    iget-object v4, p2, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    if-eqz v4, :cond_3b
+
+    iget-object v4, p2, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    invoke-virtual {v4}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v4
+
+    if-eqz v4, :cond_3b
+
+    const/4 v2, 0x0
+
+    const/4 v3, -0x1
+
+    :try_start_10
+    instance-of v4, p1, Lcom/android/server/am/BroadcastFilter;
+
+    if-eqz v4, :cond_3c
+
+    move-object v0, p1
+
+    check-cast v0, Lcom/android/server/am/BroadcastFilter;
+
+    move-object v4, v0
+
+    iget-object v4, v4, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;
+
+    iget-object v4, v4, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;
+
+    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+
+    iget-object v2, v4, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
+
+    check-cast p1, Lcom/android/server/am/BroadcastFilter;
+
+    iget-object v4, p1, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;
+
+    iget-object v4, v4, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;
+
+    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+
+    iget v3, v4, Landroid/content/pm/ApplicationInfo;->uid:I
+    :try_end_2a
+    .catch Ljava/lang/Exception; {:try_start_10 .. :try_end_2a} :catch_53
+
+    :cond_2a
+    :goto_2a
+    if-eqz v2, :cond_3b
+
+    const/4 v4, -0x1
+
+    if-eq v3, v4, :cond_3b
+
+    iget-object v4, p2, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    const/4 v5, 0x0
+
+    iget-object v6, p2, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
+
+    invoke-interface {v6}, Ljava/util/List;->size()I
+
+    move-result v6
+
+    invoke-static {v2, v3, v4, v5, v6}, Landroid/privacy/surrogate/PrivacyActivityManagerService;->enforcePrivacyPermission(Ljava/lang/String;ILandroid/content/Intent;Landroid/content/Context;I)V
+
+    :cond_3b
+    :goto_3b
+    return-void
+
+    :cond_3c
+    :try_start_3c
+    instance-of v4, p1, Landroid/content/pm/ResolveInfo;
+
+    if-eqz v4, :cond_2a
+
+    move-object v0, p1
+
+    check-cast v0, Landroid/content/pm/ResolveInfo;
+
+    move-object v4, v0
+
+    iget-object v4, v4, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
+
+    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;
+
+    iget-object v2, v4, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
+
+    check-cast p1, Landroid/content/pm/ResolveInfo;
+
+    iget-object v4, p1, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
+
+    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;
+
+    iget v3, v4, Landroid/content/pm/ApplicationInfo;->uid:I
+    :try_end_52
+    .catch Ljava/lang/Exception; {:try_start_3c .. :try_end_52} :catch_53
+
+    goto :goto_2a
+
+    :catch_53
+    move-exception v1
+
+    goto :goto_3b
+.end method
+
 .method private static performReceiveLocked(Lcom/android/server/am/ProcessRecord;Landroid/content/IIntentReceiver;Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;ZZI)V
     .registers 18
     .annotation system Ldalvik/annotation/Throws;
@@ -2312,15 +2424,15 @@
 .end method
 
 .method final processNextBroadcast(Z)V
-    .registers 38
+    .registers 39
 
     move-object/from16 v0, p0
 
     iget-object v0, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v35, v0
+    move-object/from16 v36, v0
 
-    monitor-enter v35
+    monitor-enter v36
 
     :try_start_7
     move-object/from16 v0, p0
@@ -2357,15 +2469,15 @@
 
     invoke-virtual {v3, v5}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;
 
-    move-result-object v29
+    move-result-object v30
 
-    check-cast v29, Lcom/android/server/am/BroadcastRecord;
+    check-cast v30, Lcom/android/server/am/BroadcastRecord;
 
     invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J
 
     move-result-wide v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J
 
@@ -2373,17 +2485,17 @@
 
     move-result-wide v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchClockTime:J
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     move-object/from16 v1, p0
 
     iput-object v0, v1, Lcom/android/server/am/BroadcastQueue;->mCurrentBroadcast:Lcom/android/server/am/BroadcastRecord;
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
@@ -2391,43 +2503,43 @@
 
     move-result v12
 
-    const/16 v18, 0x0
+    const/16 v19, 0x0
 
     :goto_4a
-    move/from16 v0, v18
+    move/from16 v0, v19
 
     if-ge v0, v12, :cond_67
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
-    move/from16 v0, v18
+    move/from16 v0, v19
 
     invoke-interface {v3, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
-    move-result-object v32
+    move-result-object v33
 
-    check-cast v32, Lcom/android/server/am/BroadcastFilter;
+    check-cast v33, Lcom/android/server/am/BroadcastFilter;
 
     const/4 v3, 0x0
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v29
+    move-object/from16 v1, v30
 
-    move-object/from16 v2, v32
+    move-object/from16 v2, v33
 
     invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/BroadcastQueue;->deliverToRegisteredReceiverLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/BroadcastFilter;Z)V
 
-    add-int/lit8 v18, v18, 0x1
+    add-int/lit8 v19, v19, 0x1
 
     goto :goto_4a
 
     :cond_67
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v29
+    move-object/from16 v1, v30
 
     invoke-direct {v0, v1}, Lcom/android/server/am/BroadcastQueue;->addBroadcastToHistoryLocked(Lcom/android/server/am/BroadcastRecord;)V
 
@@ -2442,7 +2554,7 @@
     :catchall_74
     move-exception v3
 
-    monitor-exit v35
+    monitor-exit v36
     :try_end_76
     .catchall {:try_start_7 .. :try_end_76} :catchall_74
 
@@ -2487,17 +2599,17 @@
 
     if-nez v3, :cond_9f
 
-    const/16 v20, 0x1
+    const/16 v21, 0x1
 
     :goto_9a
     monitor-exit v5
     :try_end_9b
     .catchall {:try_start_84 .. :try_end_9b} :catchall_a2
 
-    if-nez v20, :cond_a5
+    if-nez v21, :cond_a5
 
     :try_start_9d
-    monitor-exit v35
+    monitor-exit v36
     :try_end_9e
     .catchall {:try_start_9d .. :try_end_9e} :catchall_74
 
@@ -2505,7 +2617,7 @@
     return-void
 
     :cond_9f
-    const/16 v20, 0x0
+    const/16 v21, 0x0
 
     goto :goto_9a
 
@@ -2594,7 +2706,7 @@
     iput-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;
 
     :cond_ed
-    const/16 v22, 0x0
+    const/16 v23, 0x0
 
     :cond_ef
     move-object/from16 v0, p0
@@ -2613,7 +2725,7 @@
 
     invoke-virtual {v3}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V
 
-    if-eqz v22, :cond_109
+    if-eqz v23, :cond_109
 
     move-object/from16 v0, p0
 
@@ -2622,7 +2734,7 @@
     invoke-virtual {v3}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()V
 
     :cond_109
-    monitor-exit v35
+    monitor-exit v36
 
     goto :goto_9e
 
@@ -2635,31 +2747,31 @@
 
     invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
-    move-result-object v29
+    move-result-object v30
 
-    check-cast v29, Lcom/android/server/am/BroadcastRecord;
+    check-cast v30, Lcom/android/server/am/BroadcastRecord;
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     move-object/from16 v1, p0
 
     iput-object v0, v1, Lcom/android/server/am/BroadcastQueue;->mCurrentBroadcast:Lcom/android/server/am/BroadcastRecord;
 
-    const/16 v17, 0x0
+    const/16 v18, 0x0
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
     if-eqz v3, :cond_1ee
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
     invoke-interface {v3}, Ljava/util/List;->size()I
 
-    move-result v27
+    move-result v28
 
     :goto_12c
     move-object/from16 v0, p0
@@ -2670,7 +2782,7 @@
 
     if-eqz v3, :cond_1e5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J
 
@@ -2682,11 +2794,11 @@
 
     invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J
 
-    move-result-wide v25
+    move-result-wide v26
 
-    if-lez v27, :cond_1e5
+    if-lez v28, :cond_1e5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J
 
@@ -2698,7 +2810,7 @@
 
     mul-long/2addr v7, v9
 
-    move/from16 v0, v27
+    move/from16 v0, v28
 
     int-to-long v9, v0
 
@@ -2706,7 +2818,7 @@
 
     add-long/2addr v5, v7
 
-    cmp-long v3, v25, v5
+    cmp-long v3, v26, v5
 
     if-lez v3, :cond_1e5
 
@@ -2742,7 +2854,7 @@
 
     move-result-object v5
 
-    move-wide/from16 v0, v25
+    move-wide/from16 v0, v26
 
     invoke-virtual {v5, v0, v1}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
 
@@ -2754,7 +2866,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-wide v6, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J
 
@@ -2768,7 +2880,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-wide v6, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J
 
@@ -2782,7 +2894,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -2796,7 +2908,7 @@
 
     move-result-object v5
 
-    move/from16 v0, v27
+    move/from16 v0, v28
 
     invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
@@ -2808,7 +2920,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I
 
@@ -2822,7 +2934,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
@@ -2842,55 +2954,55 @@
 
     invoke-virtual {v0, v3}, Lcom/android/server/am/BroadcastQueue;->broadcastTimeoutLocked(Z)V
 
-    const/16 v17, 0x1
+    const/16 v18, 0x1
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
     :cond_1e5
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
     if-eqz v3, :cond_1f2
 
-    monitor-exit v35
+    monitor-exit v36
 
     goto/16 :goto_9e
 
     :cond_1ee
-    const/16 v27, 0x0
+    const/16 v28, 0x0
 
     goto/16 :goto_12c
 
     :cond_1f2
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
     if-eqz v3, :cond_208
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v3, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I
 
-    move/from16 v0, v27
+    move/from16 v0, v28
 
     if-ge v3, v0, :cond_208
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-boolean v3, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z
 
     if-nez v3, :cond_208
 
-    if-eqz v17, :cond_254
+    if-eqz v18, :cond_254
 
     :cond_208
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->resultTo:Landroid/content/IIntentReceiver;
     :try_end_20c
@@ -2899,31 +3011,31 @@
     if-eqz v3, :cond_239
 
     :try_start_20e
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->callerApp:Lcom/android/server/am/ProcessRecord;
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v4, v0, Lcom/android/server/am/BroadcastRecord;->resultTo:Landroid/content/IIntentReceiver;
 
     new-instance v5, Landroid/content/Intent;
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
     invoke-direct {v5, v6}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v7, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v8, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;
 
@@ -2931,7 +3043,7 @@
 
     const/4 v10, 0x0
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v11, v0, Lcom/android/server/am/BroadcastRecord;->userId:I
 
@@ -2939,12 +3051,12 @@
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->resultTo:Landroid/content/IIntentReceiver;
     :try_end_239
     .catchall {:try_start_20e .. :try_end_239} :catchall_74
-    .catch Landroid/os/RemoteException; {:try_start_20e .. :try_end_239} :catch_2cd
+    .catch Landroid/os/RemoteException; {:try_start_20e .. :try_end_239} :catch_2fe
 
     :cond_239
     :goto_239
@@ -2953,7 +3065,7 @@
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v29
+    move-object/from16 v1, v30
 
     invoke-direct {v0, v1}, Lcom/android/server/am/BroadcastQueue;->addBroadcastToHistoryLocked(Lcom/android/server/am/BroadcastRecord;)V
 
@@ -2971,22 +3083,22 @@
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mCurrentBroadcast:Lcom/android/server/am/BroadcastRecord;
 
-    const/16 v29, 0x0
+    const/16 v30, 0x0
 
-    const/16 v22, 0x1
+    const/16 v23, 0x1
 
     :cond_254
-    if-eqz v29, :cond_ef
+    if-eqz v30, :cond_ef
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I
 
-    move/from16 v30, v0
+    move/from16 v31, v0
 
-    add-int/lit8 v3, v30, 0x1
+    add-int/lit8 v3, v31, 0x1
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I
 
@@ -2994,17 +3106,17 @@
 
     move-result-wide v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J
 
-    if-nez v30, :cond_27c
+    if-nez v31, :cond_27c
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J
 
@@ -3012,7 +3124,7 @@
 
     move-result-wide v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchClockTime:J
 
@@ -3023,7 +3135,7 @@
 
     if-nez v3, :cond_293
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J
 
@@ -3031,76 +3143,126 @@
 
     iget-wide v7, v0, Lcom/android/server/am/BroadcastQueue;->mTimeoutPeriod:J
 
-    add-long v33, v5, v7
+    add-long v34, v5, v7
 
     move-object/from16 v0, p0
 
-    move-wide/from16 v1, v33
+    move-wide/from16 v1, v34
 
     invoke-virtual {v0, v1, v2}, Lcom/android/server/am/BroadcastQueue;->setBroadcastTimeoutLocked(J)V
 
     :cond_293
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
-    move/from16 v0, v30
+    move/from16 v0, v31
 
     invoke-interface {v3, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
-    move-result-object v24
+    move-result-object v25
+
+    move-object/from16 v0, p0
+
+    move-object/from16 v1, v25
+
+    move-object/from16 v2, v30
+
+    invoke-direct {v0, v1, v2}, Lcom/android/server/am/BroadcastQueue;->enforcePrivacyPermission(Ljava/lang/Object;Lcom/android/server/am/BroadcastRecord;)V
+
+    const/16 v16, 0x0
+
+    if-eqz v30, :cond_2cc
+
+    move-object/from16 v0, v30
+
+    iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    if-eqz v3, :cond_2cc
+
+    move-object/from16 v0, v30
+
+    iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    invoke-virtual {v3}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v3
+
+    if-eqz v3, :cond_2cc
+
+    move-object/from16 v0, v30
+
+    iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    invoke-virtual {v3}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v3
+
+    const-string v5, "catchBootComplete"
+
+    invoke-virtual {v3, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v3
+
+    if-eqz v3, :cond_2cc
 
-    move-object/from16 v0, v24
+    const/16 v16, 0x1
+
+    :cond_2cc
+    move-object/from16 v0, v25
 
     instance-of v3, v0, Lcom/android/server/am/BroadcastFilter;
 
-    if-eqz v3, :cond_2fa
+    if-eqz v3, :cond_33f
 
-    move-object/from16 v0, v24
+    move-object/from16 v0, v25
 
     check-cast v0, Lcom/android/server/am/BroadcastFilter;
 
-    move-object/from16 v16, v0
+    move-object/from16 v17, v0
+
+    if-nez v16, :cond_32b
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-boolean v3, v0, Lcom/android/server/am/BroadcastRecord;->ordered:Z
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v29
+    move-object/from16 v1, v30
 
-    move-object/from16 v2, v16
+    move-object/from16 v2, v17
 
     invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/BroadcastQueue;->deliverToRegisteredReceiverLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/BroadcastFilter;Z)V
 
-    move-object/from16 v0, v29
+    :goto_2e7
+    move-object/from16 v0, v30
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;
 
-    if-eqz v3, :cond_2c2
+    if-eqz v3, :cond_2f3
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-boolean v3, v0, Lcom/android/server/am/BroadcastRecord;->ordered:Z
 
-    if-nez v3, :cond_2ca
+    if-nez v3, :cond_2fb
 
-    :cond_2c2
+    :cond_2f3
     const/4 v3, 0x0
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/BroadcastQueue;->scheduleBroadcastsLocked()V
 
-    :cond_2ca
-    monitor-exit v35
+    :cond_2fb
+    monitor-exit v36
 
     goto/16 :goto_9e
 
-    :catch_2cd
+    :catch_2fe
     move-exception v15
 
     const-string v3, "BroadcastQueue"
@@ -3129,7 +3291,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -3145,16 +3307,39 @@
 
     goto/16 :goto_239
 
-    :cond_2fa
-    move-object/from16 v0, v24
+    :cond_32b
+    const/4 v3, 0x0
+
+    move-object/from16 v0, v30
+
+    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;
+
+    const/4 v3, 0x0
+
+    move-object/from16 v0, v30
+
+    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;
+
+    move-object/from16 v0, v30
+
+    iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    const-string v5, "android.intent.action.BOOT_COMPLETED"
+
+    invoke-virtual {v3, v5}, Landroid/content/Intent;->setAction(Ljava/lang/String;)Landroid/content/Intent;
+
+    goto :goto_2e7
+
+    :cond_33f
+    move-object/from16 v0, v25
 
     check-cast v0, Landroid/content/pm/ResolveInfo;
 
-    move-object/from16 v19, v0
+    move-object/from16 v20, v0
 
     new-instance v14, Landroid/content/ComponentName;
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3162,7 +3347,7 @@
 
     iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3170,27 +3355,27 @@
 
     invoke-direct {v14, v3, v5}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V
 
-    const/16 v31, 0x0
+    const/16 v32, 0x0
 
     move-object/from16 v0, p0
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-object v4, v5, Landroid/content/pm/ActivityInfo;->permission:Ljava/lang/String;
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v5, v0, Lcom/android/server/am/BroadcastRecord;->callingPid:I
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v7, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3198,7 +3383,7 @@
 
     iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v8, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3206,17 +3391,17 @@
 
     invoke-virtual/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;IIIZ)I
 
-    move-result v28
+    move-result v29
 
-    if-eqz v28, :cond_3b5
+    if-eqz v29, :cond_3fa
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-boolean v3, v3, Landroid/content/pm/ActivityInfo;->exported:Z
 
-    if-nez v3, :cond_4ee
+    if-nez v3, :cond_540
 
     const-string v3, "BroadcastQueue"
 
@@ -3230,7 +3415,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -3248,7 +3433,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;
 
@@ -3262,7 +3447,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingPid:I
 
@@ -3276,7 +3461,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
@@ -3296,7 +3481,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3328,11 +3513,11 @@
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    :goto_3b3
-    const/16 v31, 0x1
+    :goto_3f8
+    const/16 v32, 0x1
 
-    :cond_3b5
-    move-object/from16 v0, v19
+    :cond_3fa
+    move-object/from16 v0, v20
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3342,26 +3527,26 @@
 
     const/16 v5, 0x3e8
 
-    if-eq v3, v5, :cond_439
+    if-eq v3, v5, :cond_47e
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;
-    :try_end_3c5
-    .catchall {:try_start_239 .. :try_end_3c5} :catchall_74
+    :try_end_40a
+    .catchall {:try_start_239 .. :try_end_40a} :catchall_74
 
-    if-eqz v3, :cond_439
+    if-eqz v3, :cond_47e
 
-    :try_start_3c7
+    :try_start_40c
     invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
 
     move-result-object v3
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v5, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3370,16 +3555,16 @@
     iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
     invoke-interface {v3, v5, v6}, Landroid/content/pm/IPackageManager;->checkPermission(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_3da
-    .catchall {:try_start_3c7 .. :try_end_3da} :catchall_74
-    .catch Landroid/os/RemoteException; {:try_start_3c7 .. :try_end_3da} :catch_55e
+    :try_end_41f
+    .catchall {:try_start_40c .. :try_end_41f} :catchall_74
+    .catch Landroid/os/RemoteException; {:try_start_40c .. :try_end_41f} :catch_5b0
 
-    move-result v28
+    move-result v29
 
-    :goto_3db
-    if-eqz v28, :cond_439
+    :goto_420
+    if-eqz v29, :cond_47e
 
-    :try_start_3dd
+    :try_start_422
     const-string v3, "BroadcastQueue"
 
     new-instance v5, Ljava/lang/StringBuilder;
@@ -3392,7 +3577,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -3420,7 +3605,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;
 
@@ -3434,7 +3619,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;
 
@@ -3448,7 +3633,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
@@ -3468,16 +3653,16 @@
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    const/16 v31, 0x1
+    const/16 v32, 0x1
 
-    :cond_439
-    move-object/from16 v0, v29
+    :cond_47e
+    move-object/from16 v0, v30
 
     iget v3, v0, Lcom/android/server/am/BroadcastRecord;->appOp:I
 
     const/4 v5, -0x1
 
-    if-eq v3, v5, :cond_460
+    if-eq v3, v5, :cond_4a5
 
     move-object/from16 v0, p0
 
@@ -3485,11 +3670,11 @@
 
     iget-object v3, v3, Lcom/android/server/am/ActivityManagerService;->mAppOpsService:Lcom/android/server/AppOpsService;
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v5, v0, Lcom/android/server/am/BroadcastRecord;->appOp:I
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3497,64 +3682,64 @@
 
     iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v7, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-object v7, v7, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;
 
     invoke-virtual {v3, v5, v6, v7}, Lcom/android/server/AppOpsService;->checkOperation(IILjava/lang/String;)I
-    :try_end_45b
-    .catchall {:try_start_3dd .. :try_end_45b} :catchall_74
+    :try_end_4a0
+    .catchall {:try_start_422 .. :try_end_4a0} :catchall_74
 
-    move-result v23
+    move-result v24
 
-    if-eqz v23, :cond_460
+    if-eqz v24, :cond_4a5
 
-    const/16 v31, 0x1
+    const/16 v32, 0x1
 
-    :cond_460
-    const/16 v21, 0x0
+    :cond_4a5
+    const/16 v22, 0x0
 
-    :try_start_462
+    :try_start_4a7
     move-object/from16 v0, p0
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-object v5, v5, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-object v6, v6, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v7, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-object v7, v7, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v8, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget v8, v8, Landroid/content/pm/ActivityInfo;->flags:I
 
     invoke-virtual {v3, v5, v6, v7, v8}, Lcom/android/server/am/ActivityManagerService;->isSingleton(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;I)Z
-    :try_end_481
-    .catchall {:try_start_462 .. :try_end_481} :catchall_74
-    .catch Ljava/lang/SecurityException; {:try_start_462 .. :try_end_481} :catch_563
-
-    move-result v21
-
-    :goto_482
-    :try_start_482
-    move-object/from16 v0, v19
+    :try_end_4c6
+    .catchall {:try_start_4a7 .. :try_end_4c6} :catchall_74
+    .catch Ljava/lang/SecurityException; {:try_start_4a7 .. :try_end_4c6} :catch_5b5
+
+    move-result v22
+
+    :goto_4c7
+    :try_start_4c7
+    move-object/from16 v0, v20
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3564,11 +3749,11 @@
 
     and-int/2addr v3, v5
 
-    if-eqz v3, :cond_4c7
+    if-eqz v3, :cond_50c
 
     const-string v3, "android.permission.INTERACT_ACROSS_USERS"
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3580,7 +3765,7 @@
 
     move-result v3
 
-    if-eqz v3, :cond_4c7
+    if-eqz v3, :cond_50c
 
     const-string v3, "BroadcastQueue"
 
@@ -3620,53 +3805,66 @@
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    const/16 v31, 0x1
+    const/16 v32, 0x1
 
-    :cond_4c7
-    move-object/from16 v0, v29
+    :cond_50c
+    move-object/from16 v0, v30
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;
 
-    if-eqz v3, :cond_4d7
+    if-eqz v3, :cond_51c
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;
 
     iget-boolean v3, v3, Lcom/android/server/am/ProcessRecord;->crashing:Z
 
-    if-eqz v3, :cond_4d7
+    if-eqz v3, :cond_51c
+
+    const/16 v32, 0x1
+
+    :cond_51c
+    if-eqz v16, :cond_529
+
+    const/16 v32, 0x1
+
+    move-object/from16 v0, v30
+
+    iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    const-string v5, "android.intent.action.BOOT_COMPLETED"
 
-    const/16 v31, 0x1
+    invoke-virtual {v3, v5}, Landroid/content/Intent;->setAction(Ljava/lang/String;)Landroid/content/Intent;
 
-    :cond_4d7
-    if-eqz v31, :cond_571
+    :cond_529
+    if-eqz v32, :cond_5c3
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/BroadcastQueue;->scheduleBroadcastsLocked()V
 
-    monitor-exit v35
+    monitor-exit v36
 
     goto/16 :goto_9e
 
-    :cond_4ee
+    :cond_540
     const-string v3, "BroadcastQueue"
 
     new-instance v5, Ljava/lang/StringBuilder;
@@ -3679,7 +3877,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -3697,7 +3895,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;
 
@@ -3711,7 +3909,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingPid:I
 
@@ -3725,7 +3923,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
@@ -3745,7 +3943,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3775,16 +3973,16 @@
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto/16 :goto_3b3
+    goto/16 :goto_3f8
 
-    :catch_55e
+    :catch_5b0
     move-exception v15
 
-    const/16 v28, -0x1
+    const/16 v29, -0x1
 
-    goto/16 :goto_3db
+    goto/16 :goto_420
 
-    :catch_563
+    :catch_5b5
     move-exception v15
 
     const-string v3, "BroadcastQueue"
@@ -3795,42 +3993,42 @@
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    const/16 v31, 0x1
+    const/16 v32, 0x1
 
-    goto/16 :goto_482
+    goto/16 :goto_4c7
 
-    :cond_571
+    :cond_5c3
     const/4 v3, 0x1
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-object v4, v3, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput-object v14, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v3, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
     const/16 v5, 0x3e8
 
-    if-eq v3, v5, :cond_59b
+    if-eq v3, v5, :cond_5ed
 
-    if-eqz v21, :cond_59b
+    if-eqz v22, :cond_5ed
 
     move-object/from16 v0, p0
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3840,27 +4038,27 @@
 
     move-result-object v3
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iput-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
-    :cond_59b
-    move-object/from16 v0, v19
+    :cond_5ed
+    move-object/from16 v0, v20
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curReceiver:Landroid/content/pm/ActivityInfo;
-    :try_end_5a3
-    .catchall {:try_start_482 .. :try_end_5a3} :catchall_74
+    :try_end_5f5
+    .catchall {:try_start_4c7 .. :try_end_5f5} :catchall_74
 
-    :try_start_5a3
+    :try_start_5f5
     invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
 
     move-result-object v3
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v5, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
@@ -3870,7 +4068,7 @@
 
     const/4 v6, 0x0
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v7, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
@@ -3879,18 +4077,18 @@
     move-result v7
 
     invoke-interface {v3, v5, v6, v7}, Landroid/content/pm/IPackageManager;->setPackageStoppedState(Ljava/lang/String;ZI)V
-    :try_end_5bb
-    .catchall {:try_start_5a3 .. :try_end_5bb} :catchall_74
-    .catch Landroid/os/RemoteException; {:try_start_5a3 .. :try_end_5bb} :catch_738
-    .catch Ljava/lang/IllegalArgumentException; {:try_start_5a3 .. :try_end_5bb} :catch_5e4
+    :try_end_60d
+    .catchall {:try_start_5f5 .. :try_end_60d} :catchall_74
+    .catch Landroid/os/RemoteException; {:try_start_5f5 .. :try_end_60d} :catch_78a
+    .catch Ljava/lang/IllegalArgumentException; {:try_start_5f5 .. :try_end_60d} :catch_636
 
-    :goto_5bb
-    :try_start_5bb
+    :goto_60d
+    :try_start_60d
     move-object/from16 v0, p0
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3902,16 +4100,16 @@
 
     move-result-object v13
 
-    if-eqz v13, :cond_62d
+    if-eqz v13, :cond_67f
 
     iget-object v3, v13, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;
-    :try_end_5cf
-    .catchall {:try_start_5bb .. :try_end_5cf} :catchall_74
+    :try_end_621
+    .catchall {:try_start_60d .. :try_end_621} :catchall_74
 
-    if-eqz v3, :cond_62d
+    if-eqz v3, :cond_67f
 
-    :try_start_5d1
-    move-object/from16 v0, v19
+    :try_start_623
+    move-object/from16 v0, v20
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3921,20 +4119,20 @@
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v29
+    move-object/from16 v1, v30
 
     invoke-direct {v0, v1, v13}, Lcom/android/server/am/BroadcastQueue;->processCurBroadcastLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/ProcessRecord;)V
-    :try_end_5e1
-    .catchall {:try_start_5d1 .. :try_end_5e1} :catchall_74
-    .catch Landroid/os/RemoteException; {:try_start_5d1 .. :try_end_5e1} :catch_610
-    .catch Ljava/lang/RuntimeException; {:try_start_5d1 .. :try_end_5e1} :catch_6d1
+    :try_end_633
+    .catchall {:try_start_623 .. :try_end_633} :catchall_74
+    .catch Landroid/os/RemoteException; {:try_start_623 .. :try_end_633} :catch_662
+    .catch Ljava/lang/RuntimeException; {:try_start_623 .. :try_end_633} :catch_723
 
-    :try_start_5e1
-    monitor-exit v35
+    :try_start_633
+    monitor-exit v36
 
     goto/16 :goto_9e
 
-    :catch_5e4
+    :catch_636
     move-exception v15
 
     const-string v3, "BroadcastQueue"
@@ -3949,7 +4147,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
@@ -3977,9 +4175,9 @@
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto :goto_5bb
+    goto :goto_60d
 
-    :catch_610
+    :catch_662
     move-exception v15
 
     const-string v3, "BroadcastQueue"
@@ -3994,7 +4192,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
@@ -4008,12 +4206,12 @@
 
     invoke-static {v3, v5, v15}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    :cond_62d
+    :cond_67f
     move-object/from16 v0, p0
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4021,7 +4219,7 @@
 
     const/4 v6, 0x1
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v7, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -4033,11 +4231,11 @@
 
     const-string v8, "broadcast"
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v9, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v10, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -4049,22 +4247,22 @@
 
     and-int/2addr v10, v11
 
-    if-eqz v10, :cond_726
+    if-eqz v10, :cond_778
 
     const/4 v10, 0x1
 
-    :goto_656
+    :goto_6a8
     const/4 v11, 0x0
 
     invoke-virtual/range {v3 .. v11}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;ZZ)Lcom/android/server/am/ProcessRecord;
 
     move-result-object v3
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;
 
-    if-nez v3, :cond_729
+    if-nez v3, :cond_77b
 
     const-string v3, "BroadcastQueue"
 
@@ -4078,7 +4276,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4096,7 +4294,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v19
+    move-object/from16 v0, v20
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4114,7 +4312,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -4136,23 +4334,23 @@
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v29
+    move-object/from16 v1, v30
 
     invoke-virtual {v0, v1}, Lcom/android/server/am/BroadcastQueue;->logBroadcastReceiverDiscardLocked(Lcom/android/server/am/BroadcastRecord;)V
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v7, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v8, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v9, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-boolean v10, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z
 
@@ -4160,7 +4358,7 @@
 
     move-object/from16 v5, p0
 
-    move-object/from16 v6, v29
+    move-object/from16 v6, v30
 
     invoke-virtual/range {v5 .. v11}, Lcom/android/server/am/BroadcastQueue;->finishReceiverLocked(Lcom/android/server/am/BroadcastRecord;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z
 
@@ -4168,15 +4366,15 @@
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
-    monitor-exit v35
+    monitor-exit v36
 
     goto/16 :goto_9e
 
-    :catch_6d1
+    :catch_723
     move-exception v15
 
     const-string v3, "BroadcastQueue"
@@ -4191,7 +4389,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
@@ -4205,7 +4403,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -4221,23 +4419,23 @@
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v29
+    move-object/from16 v1, v30
 
     invoke-virtual {v0, v1}, Lcom/android/server/am/BroadcastQueue;->logBroadcastReceiverDiscardLocked(Lcom/android/server/am/BroadcastRecord;)V
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget v5, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-object v7, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iget-boolean v8, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z
 
@@ -4245,7 +4443,7 @@
 
     move-object/from16 v3, p0
 
-    move-object/from16 v4, v29
+    move-object/from16 v4, v30
 
     invoke-virtual/range {v3 .. v9}, Lcom/android/server/am/BroadcastQueue;->finishReceiverLocked(Lcom/android/server/am/BroadcastRecord;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z
 
@@ -4253,42 +4451,42 @@
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v29
+    move-object/from16 v0, v30
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
-    monitor-exit v35
+    monitor-exit v36
 
     goto/16 :goto_9e
 
-    :cond_726
+    :cond_778
     const/4 v10, 0x0
 
-    goto/16 :goto_656
+    goto/16 :goto_6a8
 
-    :cond_729
-    move-object/from16 v0, v29
+    :cond_77b
+    move-object/from16 v0, v30
 
     move-object/from16 v1, p0
 
     iput-object v0, v1, Lcom/android/server/am/BroadcastQueue;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;
 
-    move/from16 v0, v30
+    move/from16 v0, v31
 
     move-object/from16 v1, p0
 
     iput v0, v1, Lcom/android/server/am/BroadcastQueue;->mPendingBroadcastRecvIndex:I
 
-    monitor-exit v35
-    :try_end_736
-    .catchall {:try_start_5e1 .. :try_end_736} :catchall_74
+    monitor-exit v36
+    :try_end_788
+    .catchall {:try_start_633 .. :try_end_788} :catchall_74
 
     goto/16 :goto_9e
 
-    :catch_738
+    :catch_78a
     move-exception v3
 
-    goto/16 :goto_5bb
+    goto/16 :goto_60d
 .end method
 
 .method public final replaceOrderedBroadcastLocked(Lcom/android/server/am/BroadcastRecord;)Z
