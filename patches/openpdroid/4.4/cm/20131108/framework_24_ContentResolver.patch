diff -Npruw stock-framework*/smali/android/content/ContentResolver.smali pdroid-framework*/smali/android/content/ContentResolver.smali
--- stock-framework*/smali/android/content/ContentResolver.smali	2013-11-08 16:55:09.122487414 -0600
+++ pdroid-framework*/smali/android/content/ContentResolver.smali	2013-11-08 16:55:30.202486861 -0600
@@ -3782,8 +3782,8 @@
 
     invoke-virtual {v0, v10}, Landroid/os/CancellationSignal;->setRemote(Landroid/os/ICancellationSignal;)V
     :try_end_1f
-    .catchall {:try_start_c .. :try_end_1f} :catchall_f9
-    .catch Landroid/os/RemoteException; {:try_start_c .. :try_end_1f} :catch_d9
+    .catchall {:try_start_c .. :try_end_1f} :catchall_115
+    .catch Landroid/os/RemoteException; {:try_start_c .. :try_end_1f} :catch_f5
 
     :cond_1f
     :try_start_1f
@@ -3802,24 +3802,38 @@
     move-object/from16 v9, p5
 
     invoke-interface/range {v3 .. v10}, Landroid/content/IContentProvider;->query(Ljava/lang/String;Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;Landroid/os/ICancellationSignal;)Landroid/database/Cursor;
-    :try_end_30
-    .catchall {:try_start_1f .. :try_end_30} :catchall_f9
-    .catch Landroid/os/DeadObjectException; {:try_start_1f .. :try_end_30} :catch_51
-    .catch Landroid/os/RemoteException; {:try_start_1f .. :try_end_30} :catch_d9
 
     move-result-object v20
 
-    :goto_31
-    if-nez v20, :cond_90
+    move-object/from16 v0, p0
+
+    iget-object v4, v0, Landroid/content/ContentResolver;->mContext:Landroid/content/Context;
+
+    move-object/from16 v0, p1
+
+    move-object/from16 v1, p2
+
+    move-object/from16 v2, v20
+
+    invoke-static {v0, v1, v4, v2}, Landroid/privacy/surrogate/PrivacyContentResolver;->enforcePrivacyPermission(Landroid/net/Uri;[Ljava/lang/String;Landroid/content/Context;Landroid/database/Cursor;)Landroid/database/Cursor;
+    :try_end_3e
+    .catchall {:try_start_1f .. :try_end_3e} :catchall_115
+    .catch Landroid/os/DeadObjectException; {:try_start_1f .. :try_end_3e} :catch_5f
+    .catch Landroid/os/RemoteException; {:try_start_1f .. :try_end_3e} :catch_f5
+
+    move-result-object v20
+
+    :goto_3f
+    if-nez v20, :cond_ac
 
     const/16 v23, 0x0
 
-    if-eqz v20, :cond_3a
+    if-eqz v20, :cond_48
 
     invoke-interface/range {v20 .. v20}, Landroid/database/Cursor;->close()V
 
-    :cond_3a
-    if-eqz p6, :cond_42
+    :cond_48
+    if-eqz p6, :cond_50
 
     const/4 v4, 0x0
 
@@ -3827,14 +3841,14 @@
 
     invoke-virtual {v0, v4}, Landroid/os/CancellationSignal;->setRemote(Landroid/os/ICancellationSignal;)V
 
-    :cond_42
-    if-eqz v3, :cond_49
+    :cond_50
+    if-eqz v3, :cond_57
 
     move-object/from16 v0, p0
 
     invoke-virtual {v0, v3}, Landroid/content/ContentResolver;->releaseUnstableProvider(Landroid/content/IContentProvider;)Z
 
-    :cond_49
+    :cond_57
     if-eqz v11, :cond_8
 
     move-object/from16 v0, p0
@@ -3843,31 +3857,31 @@
 
     goto :goto_8
 
-    :catch_51
+    :catch_5f
     move-exception v19
 
-    :try_start_52
+    :try_start_60
     move-object/from16 v0, p0
 
     invoke-virtual {v0, v3}, Landroid/content/ContentResolver;->unstableProviderDied(Landroid/content/IContentProvider;)V
 
     invoke-virtual/range {p0 .. p1}, Landroid/content/ContentResolver;->acquireProvider(Landroid/net/Uri;)Landroid/content/IContentProvider;
-    :try_end_5a
-    .catchall {:try_start_52 .. :try_end_5a} :catchall_f9
-    .catch Landroid/os/RemoteException; {:try_start_52 .. :try_end_5a} :catch_d9
+    :try_end_68
+    .catchall {:try_start_60 .. :try_end_68} :catchall_115
+    .catch Landroid/os/RemoteException; {:try_start_60 .. :try_end_68} :catch_f5
 
     move-result-object v11
 
-    if-nez v11, :cond_7b
+    if-nez v11, :cond_89
 
     const/16 v23, 0x0
 
-    if-eqz v20, :cond_64
+    if-eqz v20, :cond_72
 
     invoke-interface/range {v20 .. v20}, Landroid/database/Cursor;->close()V
 
-    :cond_64
-    if-eqz p6, :cond_6c
+    :cond_72
+    if-eqz p6, :cond_7a
 
     const/4 v4, 0x0
 
@@ -3875,14 +3889,14 @@
 
     invoke-virtual {v0, v4}, Landroid/os/CancellationSignal;->setRemote(Landroid/os/ICancellationSignal;)V
 
-    :cond_6c
-    if-eqz v3, :cond_73
+    :cond_7a
+    if-eqz v3, :cond_81
 
     move-object/from16 v0, p0
 
     invoke-virtual {v0, v3}, Landroid/content/ContentResolver;->releaseUnstableProvider(Landroid/content/IContentProvider;)Z
 
-    :cond_73
+    :cond_81
     if-eqz v11, :cond_8
 
     move-object/from16 v0, p0
@@ -3891,8 +3905,8 @@
 
     goto :goto_8
 
-    :cond_7b
-    :try_start_7b
+    :cond_89
+    :try_start_89
     move-object/from16 v0, p0
 
     iget-object v12, v0, Landroid/content/ContentResolver;->mPackageName:Ljava/lang/String;
@@ -3913,9 +3927,23 @@
 
     move-result-object v20
 
-    goto :goto_31
+    move-object/from16 v0, p0
+
+    iget-object v4, v0, Landroid/content/ContentResolver;->mContext:Landroid/content/Context;
+
+    move-object/from16 v0, p1
+
+    move-object/from16 v1, p2
+
+    move-object/from16 v2, v20
+
+    invoke-static {v0, v1, v4, v2}, Landroid/privacy/surrogate/PrivacyContentResolver;->enforcePrivacyPermission(Landroid/net/Uri;[Ljava/lang/String;Landroid/content/Context;Landroid/database/Cursor;)Landroid/database/Cursor;
+
+    move-result-object v20
+
+    goto :goto_3f
 
-    :cond_90
+    :cond_ac
     invoke-interface/range {v20 .. v20}, Landroid/database/Cursor;->getCount()I
 
     invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J
@@ -3938,11 +3966,11 @@
 
     new-instance v23, Landroid/content/ContentResolver$CursorWrapperInner;
 
-    if-eqz v11, :cond_d4
+    if-eqz v11, :cond_f0
 
     move-object v4, v11
 
-    :goto_ab
+    :goto_c7
     move-object/from16 v0, v23
 
     move-object/from16 v1, p0
@@ -3950,20 +3978,20 @@
     move-object/from16 v2, v20
 
     invoke-direct {v0, v1, v2, v4}, Landroid/content/ContentResolver$CursorWrapperInner;-><init>(Landroid/content/ContentResolver;Landroid/database/Cursor;Landroid/content/IContentProvider;)V
-    :try_end_b4
-    .catchall {:try_start_7b .. :try_end_b4} :catchall_f9
-    .catch Landroid/os/RemoteException; {:try_start_7b .. :try_end_b4} :catch_d9
+    :try_end_d0
+    .catchall {:try_start_89 .. :try_end_d0} :catchall_115
+    .catch Landroid/os/RemoteException; {:try_start_89 .. :try_end_d0} :catch_f5
 
     const/4 v11, 0x0
 
     const/16 v20, 0x0
 
-    if-eqz v20, :cond_bc
+    if-eqz v20, :cond_d8
 
     invoke-interface/range {v20 .. v20}, Landroid/database/Cursor;->close()V
 
-    :cond_bc
-    if-eqz p6, :cond_c4
+    :cond_d8
+    if-eqz p6, :cond_e0
 
     const/4 v4, 0x0
 
@@ -3971,14 +3999,14 @@
 
     invoke-virtual {v0, v4}, Landroid/os/CancellationSignal;->setRemote(Landroid/os/ICancellationSignal;)V
 
-    :cond_c4
-    if-eqz v3, :cond_cb
+    :cond_e0
+    if-eqz v3, :cond_e7
 
     move-object/from16 v0, p0
 
     invoke-virtual {v0, v3}, Landroid/content/ContentResolver;->releaseUnstableProvider(Landroid/content/IContentProvider;)Z
 
-    :cond_cb
+    :cond_e7
     if-eqz v11, :cond_8
 
     move-object/from16 v0, p0
@@ -3987,28 +4015,28 @@
 
     goto/16 :goto_8
 
-    :cond_d4
-    :try_start_d4
+    :cond_f0
+    :try_start_f0
     invoke-virtual/range {p0 .. p1}, Landroid/content/ContentResolver;->acquireProvider(Landroid/net/Uri;)Landroid/content/IContentProvider;
-    :try_end_d7
-    .catchall {:try_start_d4 .. :try_end_d7} :catchall_f9
-    .catch Landroid/os/RemoteException; {:try_start_d4 .. :try_end_d7} :catch_d9
+    :try_end_f3
+    .catchall {:try_start_f0 .. :try_end_f3} :catchall_115
+    .catch Landroid/os/RemoteException; {:try_start_f0 .. :try_end_f3} :catch_f5
 
     move-result-object v4
 
-    goto :goto_ab
+    goto :goto_c7
 
-    :catch_d9
+    :catch_f5
     move-exception v19
 
     const/16 v23, 0x0
 
-    if-eqz v20, :cond_e1
+    if-eqz v20, :cond_fd
 
     invoke-interface/range {v20 .. v20}, Landroid/database/Cursor;->close()V
 
-    :cond_e1
-    if-eqz p6, :cond_e9
+    :cond_fd
+    if-eqz p6, :cond_105
 
     const/4 v4, 0x0
 
@@ -4016,14 +4044,14 @@
 
     invoke-virtual {v0, v4}, Landroid/os/CancellationSignal;->setRemote(Landroid/os/ICancellationSignal;)V
 
-    :cond_e9
-    if-eqz v3, :cond_f0
+    :cond_105
+    if-eqz v3, :cond_10c
 
     move-object/from16 v0, p0
 
     invoke-virtual {v0, v3}, Landroid/content/ContentResolver;->releaseUnstableProvider(Landroid/content/IContentProvider;)Z
 
-    :cond_f0
+    :cond_10c
     if-eqz v11, :cond_8
 
     move-object/from16 v0, p0
@@ -4032,15 +4060,15 @@
 
     goto/16 :goto_8
 
-    :catchall_f9
+    :catchall_115
     move-exception v4
 
-    if-eqz v20, :cond_ff
+    if-eqz v20, :cond_11b
 
     invoke-interface/range {v20 .. v20}, Landroid/database/Cursor;->close()V
 
-    :cond_ff
-    if-eqz p6, :cond_107
+    :cond_11b
+    if-eqz p6, :cond_123
 
     const/4 v5, 0x0
 
@@ -4048,21 +4076,21 @@
 
     invoke-virtual {v0, v5}, Landroid/os/CancellationSignal;->setRemote(Landroid/os/ICancellationSignal;)V
 
-    :cond_107
-    if-eqz v3, :cond_10e
+    :cond_123
+    if-eqz v3, :cond_12a
 
     move-object/from16 v0, p0
 
     invoke-virtual {v0, v3}, Landroid/content/ContentResolver;->releaseUnstableProvider(Landroid/content/IContentProvider;)Z
 
-    :cond_10e
-    if-eqz v11, :cond_115
+    :cond_12a
+    if-eqz v11, :cond_131
 
     move-object/from16 v0, p0
 
     invoke-virtual {v0, v11}, Landroid/content/ContentResolver;->releaseProvider(Landroid/content/IContentProvider;)Z
 
-    :cond_115
+    :cond_131
     throw v4
 .end method
 
